

	name	main
	segdef	main

	segref	UtilsA, ioa ,rd_clockA
	segref	lot_,lot_
    segref  stack_0, stack_0

    segref  power_of_two, power_of_two
    

    link    I, <UtilsA>|[ioa]
    link    D, <UtilsA>|[rd_clockA]

    temp    first       " a stack temporary @ sp+50(8)

main:
        tsx2    setupFXE
        tra pot
        "lprplp  lot_            " set-up lp to point to this segments linkage section
        "eppsp   stack_0         " set-up stack pointer

        LDA     I
        tsp2	pr4|I, *        " ioa
        acc     /Howdy world! - It's /

        "tsp2    rd_clockA
        "tsp2     <UtilsA>|[rd_clockA]
        tsp2    lp|D,*
        "tsp2    UtilsA$rd_clockA

        staq	Date        " MM/DD HH:MM
        
        tsp2	ioa
        acc     /'^g^g'\r\n/
        nop     Date
        nop     Date+1

        ldq     =123456
        stq     first
        lda     first
        sta     f

        tsp2    ioa
        acc     /first: ^d\r\n/
        nop     f

pot:
    lda     =512
    sta     .arg1
    
    ldaq	.one_arg_header
    staq	.po2_arg_list
    epp1	.arg1
    spri1	.po2_arg_list+2
    epp1	.retval
    spri1	.po2_arg_list+4


    eppap	.po2_arg_list
    
    sprp4       f
    short_call  power_of_two
    lprp4       f
    
    tsp2	ioa
    acc     /We did it!!! 2**^d=^d\r\n/
    nop     .retval
    nop     .arg1
	dis
    
  	"tempd	.temp
    "tempd	.po2_arg_list(2)
  	even

    bss     .arg1,2
    bss     .retval,2
    bss     .po2_arg_list, 4

.one_arg_header:
   	vfd	17/2,1/0,18/4
   	vfd	18/0,18/0

    
    
   tsp2    UtilsA$rd_clockA-1
   tsp2    UtilsA$rd_clockA+0
   tsp2    UtilsA$rd_clockA+1



	even
Date:	bss	2
f:      bss 1

    INCLUDE     setupFXE.as8
    
	end
